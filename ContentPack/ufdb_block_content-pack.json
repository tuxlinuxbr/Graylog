{"name":"Ufdb-Block","description":"Sent UFDB block logs to Graylog and create a live logview and statistics from blocked web sites and groups.","category":"Proxy","inputs":[{"id":"5a7330e968ce47000124a676","title":"Ufdb-Block","configuration":{"recv_buffer_size":1048576,"tcp_keepalive":false,"use_null_delimiter":false,"tls_client_auth_cert_file":"","force_rdns":false,"bind_address":"0.0.0.0","tls_cert_file":"","store_full_message":false,"expand_structured_data":true,"port":19202,"tls_key_file":"","tls_enable":false,"tls_key_password":"","max_message_size":2097152,"tls_client_auth":"disabled","override_source":null,"allow_override_date":true},"static_fields":{},"type":"org.graylog2.inputs.syslog.tcp.SyslogTCPInput","global":true,"extractors":[{"title":"UFDB Block log Extractor","type":"GROK","cursor_strategy":"COPY","target_field":"","source_field":"message","configuration":{"grok_pattern":"%{DATE_UTC:UNWANTED}%{SPACE:UNWANTED}%{TIME:UNWANTED} %{PIDPROC:UNWANTED} %{DATA:UNWANTED} %{DATA:Block_User;string} %{IPV4:Block_Client_Address}%{SPACE:UNWANTED}%{DATA:Block_Group;string} %{DATA:Block_List;string} %{UFDBURI:Block_URI;string} %{WORD:Block_Method;string}"},"converters":[],"condition_type":"NONE","condition_value":"","order":0}]}],"streams":[],"outputs":[],"dashboards":[{"title":"MINFIN - Block Sites","description":"Sitios bloqueados durante o acesso","dashboard_widgets":[{"description":"Bloqueios por minuto (15 min)","type":"SEARCH_RESULT_CHART","cache_time":10,"configuration":{"interval":"minute","timerange":{"type":"relative","range":900},"query":"application_name:ufdb-block"},"col":2,"row":1,"height":1,"width":3},{"description":"Total de bloqueios (15 min)","type":"SEARCH_RESULT_COUNT","cache_time":10,"configuration":{"timerange":{"type":"relative","range":900},"lower_is_better":false,"trend":true,"query":"application_name:ufdb-block"},"col":1,"row":1,"height":1,"width":1},{"description":"Quantidade de bloqueio por Grupo (15 min)","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":900},"field":"Block_Group","query":"application_name:ufdb-block","show_data_table":true,"limit":10,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":50},"col":1,"row":2,"height":3,"width":2},{"description":"Quantidade de bloqueio por Lista (15 min)","type":"QUICKVALUES","cache_time":10,"configuration":{"timerange":{"type":"relative","range":300},"field":"Block_List","query":"application_name:ufdb-block","show_data_table":true,"limit":15,"show_pie_chart":true,"sort_order":"desc","stacked_fields":"","data_table_limit":50},"col":3,"row":2,"height":3,"width":2}]}],"grok_patterns":[{"name":"UFDBURI","pattern":"(?:%{BLOCKURIPROTO:Block_URI_Protocol;string}:\\/\\/|)(?:%{BLOCKURIUSER:Block_URI_User;string}@|)%{BLOCKURIHOST:Block_URI_Host;string}(?:\\:%{BLOCKURIPORT:Block_URI_Port;int}|)(?:\\/%{BLOCKURIPATH:Block_URI_Path;string}|)(?:#%{BLOCKURIFRAG:Block_URI_Frag;string}|)"},{"name":"BLOCKURIFRAG","pattern":"([a-z0-9-._~!$&'()*+,;=:]+)"},{"name":"BLOCKURIPROTO","pattern":"([a-z]+)"},{"name":"BLOCKURIUSER","pattern":"([a-z0-9-._~!$&'()*+,;=:]+)"},{"name":"BLOCKURIHOST","pattern":"([a-z0-9-._~!$&'()*+,;=]+)"},{"name":"BLOCKURIPATH","pattern":"([a-zA-Z0-9-._~!$&'()*+,;=:\\/%?]+)"},{"name":"BLOCKURIPORT","pattern":"([\\d]+)"}],"lookup_tables":[],"lookup_caches":[],"lookup_data_adapters":[]}